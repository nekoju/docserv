#!/bin/bash

# Usage:
#   source <(curl -sk https://filedump.stuff/alias.sh)
#   DOC_TOKEN=abc123 DOC_HOST=host.domain:8080 doc put note.txt
#   doc get note.txt

# --- required env vars ---
: "${DOC_TOKEN:?Need to set DOC_TOKEN}"
: "${DOC_HOST:?Need to set DOC_HOST (e.g. 192.168.1.10:8080)}"

function doc() {
  local cmd="$1"
  shift

  case "$cmd" in
    get)
      local path="$1"
      curl -sk https://"${DOC_TOKEN}@${DOC_HOST}/docserver/doc/${path}"
      ;;
    put)
      local path="$1"
      curl -sk -X POST https://"${DOC_TOKEN}@${DOC_HOST}/docserver/doc/${path}" --data-binary @-
      ;;
    del|delete|rm)
      local path="$1"
      curl -sk -X DELETE https://"${DOC_TOKEN}@${DOC_HOST}/docserver/doc/${path}"
      ;;
    ls|list)
      curl -sk https://"${DOC_TOKEN}@${DOC_HOST}/docserver/list"
      ;;
    *)
      echo "Usage: doc {get|put|del|ls} path"
      ;;
  esac
}

